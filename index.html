<!DOCTYPE html>
<html lang="ru" class="bg-gray-50 text-gray-900">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cron Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
      defer
    ></script>
    <style>
      [x-cloak] {
        display: none !important;
      }
    </style>
  </head>
  <body x-data="cronApp()" class="min-h-screen flex flex-col">
    <!-- Header -->
    <header
      class="bg-black text-white py-4 px-6 flex items-center justify-between"
    >
      <h1 class="text-xl font-semibold">CronJobs Dashboard</h1>
      <button
        @click="openAddModal = true"
        class="bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition"
      >
        + –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞
      </button>
    </header>

    <!-- Main -->
    <main class="flex-1 p-6">
      <!-- Table -->
      <div class="bg-white shadow rounded-lg overflow-hidden">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-100 text-gray-700 text-sm">
            <tr>
              <th class="px-4 py-2 text-left">–ò–º—è –∑–∞–¥–∞—á–∏</th>
              <th class="px-4 py-2 text-left">URL</th>
              <th class="px-4 py-2 text-left">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</th>
              <th class="px-4 py-2 text-left">–°—Ç–∞—Ç—É—Å</th>
              <th class="px-4 py-2 text-right">–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100 text-sm">
            <template x-for="job in jobs" :key="job.id">
              <tr class="hover:bg-gray-50">
                <td class="px-4 py-2" x-text="job.name"></td>
                <td class="px-4 py-2">
                  <a
                    :href="job.url"
                    class="text-blue-600 hover:underline"
                    x-text="job.url"
                  ></a>
                </td>
                <td class="px-4 py-2" x-text="job.schedule"></td>
                <td class="px-4 py-2">
                  <span
                    class="px-2 py-1 text-xs rounded-full"
                    :class="job.active ? 'bg-green-100 text-green-700' : 'bg-gray-200 text-gray-600'"
                    x-text="job.active ? '–ê–∫—Ç–∏–≤–Ω–∞' : '–í—ã–∫–ª—é—á–µ–Ω–∞'"
                  ></span>
                </td>
                <td class="px-4 py-2 text-right space-x-2">
                  <button
                    @click="editJob(job)"
                    class="text-gray-600 hover:text-black"
                  >
                    ‚úèÔ∏è
                  </button>
                  <button
                    @click="confirmDelete(job.id)"
                    class="text-red-500 hover:text-red-700"
                  >
                    üóë
                  </button>
                </td>
              </tr>
            </template>
          </tbody>
        </table>
        <div x-show="jobs.length === 0" class="text-center py-6 text-gray-500">
          –ù–µ—Ç –∑–∞–¥–∞—á. –î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é!
        </div>
      </div>

      <!-- Add/Edit Modal -->
      <div
        x-show="openAddModal"
        x-cloak
        x-transition
        class="fixed inset-0 bg-black/50 flex items-center justify-center z-50"
      >
        <div
          class="bg-white w-full max-w-md rounded-lg shadow-lg p-6 relative"
          @click.outside="openAddModal = false"
        >
          <h2
            class="text-lg font-semibold mb-4"
            x-text="editMode ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É' : '–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞'"
          ></h2>

          <form @submit.prevent="saveJob()">
            <label class="block text-sm mb-2">–ò–º—è</label>
            <input
              type="text"
              x-model="form.name"
              class="w-full border rounded px-3 py-2 mb-3"
              required
            />

            <label class="block text-sm mb-2">URL</label>
            <input
              type="url"
              x-model="form.url"
              class="w-full border rounded px-3 py-2 mb-3"
              required
            />

            <label class="block text-sm mb-2">Cron –≤—ã—Ä–∞–∂–µ–Ω–∏–µ</label>
            <input
              type="text"
              x-model="form.schedule"
              class="w-full border rounded px-3 py-2 mb-3"
              placeholder="*/5 * * * *"
            />

            <label class="inline-flex items-center mb-3">
              <input type="checkbox" x-model="form.active" class="mr-2" />
              –ê–∫—Ç–∏–≤–Ω–∞
            </label>

            <div class="flex justify-end space-x-2 mt-4">
              <button
                type="button"
                @click="openAddModal = false"
                class="px-4 py-2 text-gray-600 hover:text-black"
              >
                –û—Ç–º–µ–Ω–∞
              </button>
              <button
                type="submit"
                class="bg-black text-white px-4 py-2 rounded hover:bg-gray-800"
              >
                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Delete Confirm Modal -->
      <div
        x-show="openDeleteModal"
        x-cloak
        x-transition
        class="fixed inset-0 bg-black/50 flex items-center justify-center z-50"
      >
        <div
          class="bg-white w-full max-w-sm rounded-lg shadow-lg p-6 text-center"
          @click.outside="openDeleteModal = false"
        >
          <h2 class="text-lg font-semibold mb-4 text-red-600">
            –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É?
          </h2>
          <p class="text-sm text-gray-600 mb-6">
            –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.
          </p>
          <div class="flex justify-center space-x-3">
            <button
              @click="openDeleteModal = false"
              class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"
            >
              –û—Ç–º–µ–Ω–∞
            </button>
            <button
              @click="deleteJob()"
              class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
            >
              –£–¥–∞–ª–∏—Ç—å
            </button>
          </div>
        </div>
      </div>
    </main>

    <script>
      function cronApp() {
        return {
          jobs: [
            {
              id: 1,
              name: "Ping API",
              url: "https://api.example.com/ping",
              schedule: "*/5 * * * *",
              active: true,
            },
            {
              id: 2,
              name: "Daily backup",
              url: "https://api.example.com/backup",
              schedule: "0 3 * * *",
              active: false,
            },
            {
              id: 3,
              name: "Generate reports",
              url: "https://api.example.com/reports",
              schedule: "30 1 * * 1",
              active: true,
            },
            {
              id: 4,
              name: "Sync data",
              url: "https://api.example.com/sync",
              schedule: "0 */6 * * *",
              active: false,
            },
            {
              id: 5,
              name: "Clean temp files",
              url: "https://api.example.com/clean",
              schedule: "15 2 * * *",
              active: true,
            },
          ],
          openAddModal: false,
          openDeleteModal: false,
          editMode: false,
          deleteId: null,
          form: { id: null, name: "", url: "", schedule: "", active: true },

          editJob(job) {
            this.form = JSON.parse(JSON.stringify(job));
            this.editMode = true;
            this.openAddModal = true;
          },
          saveJob() {
            if (this.editMode) {
              const i = this.jobs.findIndex((j) => j.id === this.form.id);
              this.jobs[i] = { ...this.form };
            } else {
              this.jobs.push({ ...this.form, id: Date.now() });
            }
            this.openAddModal = false;
            this.editMode = false;
            this.form = {
              id: null,
              name: "",
              url: "",
              schedule: "",
              active: true,
            };
          },
          confirmDelete(id) {
            this.deleteId = id;
            this.openDeleteModal = true;
          },
          deleteJob() {
            this.jobs = this.jobs.filter((j) => j.id !== this.deleteId);
            this.openDeleteModal = false;
          },
        };
      }
    </script>
  </body>
</html>
